{% extends 'AppBundle:Template:StandardTemplate.html.twig' %}

{% block title %}Städte-Übersicht{% endblock %}

{% block breadcrumb %}
    <li class="active">Städteliste</li>
{% endblock %}
    
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <h1>
                    Die nächste Masse ist ganz nah.
                </h1>

                <p class="lead">
                    Die Critical-Mass-Bewegung ist in beinahe jeder größeren Stadt zu Hause.
                </p>

                <div class="pull-right">
                    {% include 'AppBundle:CityList:_cityListSort.html.twig' %}
                </div>

                <p>
                    Auf den Sattel, fertig, los: Die folgende Liste enthält mittlerweile {{ cityList|length }} Städte.
                    Bitte bedenke, dass die folgenden Informationen aus verschiedenen Quellen im Internet stammen und
                    womöglich veraltet oder schlichtweg falsch sein können. Überprüfe bitte vorher die einschlägigen
                    Quellen wie facebook oder twitter, bevor du dich auf den Weg machst.
                </p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <table id="cityList" class="table sortableCityRideList">
                    <thead>
                    <tr>
                        <th>
                            Stadt
                        </th>
                        <th>
                            aktuelle Tour
                        </th>
                        <th>
                            Turnus
                        </th>
                        <th>
                            Touren
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for city in cityList %}
                        <tr class="city"
                            data-cityName="{{ city.city }}"
                            data-cityslug="{{ city.city.slug }}"
                            data-latitude="{{ city.city.latitude }}"
                            data-longitude="{{ city.city.longitude }}"
                            data-currentRide="{% if city.currentRide %}{{ city.currentRide.dateTime|date('Y-m-d H:i', 'Europe/Berlin') }}{% else %}9999-99-99 99:99{% endif %}"
                        >
                            <td>
                                <a href="{{ objectPath(city.city) }}">
                                    {{ city.city.city }}
                                </a>
                            </td>
                            <td>
                                {% if city.currentRide %}
                                    <a href="{{ objectPath(city.currentRide) }}">
                                        {{ city.currentRide.dateTime|format_datetime(null, 'de', 'Europe/Berlin', constant('IntlDateFormatter::LONG'), constant('IntlDateFormatter::SHORT')) }}&nbsp;Uhr
                                    </a>
                                {% endif %}
                            </td>
                            <td>
                                {% if city.city.isStandardable %}
                                jeweils am {{ ('criticalmass.city_list.event_date.month_week.' ~ city.city.standardWeekOfMonth)|trans }} {{ ('criticalmass.city_list.event_date.day.' ~ city.city.standardDayOfWeek)|trans }} um {{ city.city.standardTime|date('H:i', city.city.timezone) }} Uhr
                                {% endif %}
                            </td>
                            <td>
                                <a href="{{ path('caldera_criticalmass_desktop_city_listrides', { citySlug: city.city.slug }) }}">
                                    {{ city.countRides }}
                                </a>
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}
