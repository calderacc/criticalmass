{% extends 'AppBundle:Template:StandardTemplate.html.twig' %}

{% block title %}Städte-Übersicht{% endblock %}

{% block breadcrumb %}
    <li>
        <a href="{{ objectPath(city) }}">
            {{ city.city }}
        </a>
    </li>
    <li class="active">
        Turnus anzeigen
    </li>
{% endblock %}
    
{% block content %}
    <div class="container">
        <div class="row">
            <div class="col-md-12">
                <a class="btn btn-success pull-right"
                   href="{{ path('caldera_criticalmass_citycycle_add', { citySlug: city.mainSlugString }) }}">
                    Turnus ergänzen
                </a>

                <h2>
                    Regelmäßige Touren in {{ city.city }}
                </h2>

                <p class="lead">
                    Du kannst die monatlichen Touren in {{ city.city }} automatisch erzeugen lassen. Wenn du mit
                    Gültigkeitsbereichen arbeitest, kannst du auch komplexere Logiken implementieren, beispielsweise
                    andere Uhrzeiten für sommerliche als für winterliche Touren angeben.
                </p>
            </div>
        </div>

        <div class="row">
            <div class="col-md-12">
                <table class="table">
                    <thead>
                    <tr>
                        <th>
                            Turnus
                        </th>

                        <th>
                            Treffpunkt
                        </th>

                        <th>
                            Uhrzeit
                        </th>

                        <th>
                            Gültigkeit
                        </th>

                        <th>
                            Aktionen
                        </th>
                    </tr>
                    </thead>
                    <tbody>
                    {% for cycle in cycles %}
                        <tr {% if cycle.disabledAt %}style="text-decoration: line-through;"{% endif %}>
                            <td>
                                am {{ ('criticalmass.city_list.event_date.month_week.' ~ cycle.weekOfMonth)|trans }} {{ ('criticalmass.city_list.event_date.day.' ~ cycle.dayOfWeek)|trans }}
                                im Monat
                            </td>

                            <td>
                                {% if (cycle.location) %}
                                    {{ cycle.location }} ({{ cycle.latitude|round(3) }}, {{ cycle.longitude|round(3) }})
                                {% else %}
                                    <em>
                                        nicht definiert
                                    </em>
                                {% endif %}
                            </td>

                            <td>
                                {{ cycle.time|date('H:i', city.timezone) }} Uhr
                            </td>

                            <td>
                                {% if (cycle.range) %}
                                    {{ cycle.validFrom|date('d.m.Y') }} bis {{ cycle.validUntil|date('d.m.Y') }}
                                {% else %}
                                    <em>
                                        nicht begrenzt
                                    </em>
                                {% endif %}
                            </td>

                            <td>
                                {% if not cycle.disabledAt %}
                                <div class="btn-group">
                                    <a class="btn btn-default btn-xs"
                                       href="{{ path('caldera_criticalmass_citycycle_edit', { citySlug: city.mainSlugString, cycleId: cycle.id }) }}">
                                        <i class="fa fa-wrench"></i>
                                    </a>

                                    <a class="btn btn-default btn-xs"
                                       href="{{ path('caldera_criticalmass_citycycle_disable', { citySlug: city.mainSlugString, cycleId: cycle.id }) }}">
                                        <i class="fa fa-trash-o"></i>
                                    </a>
                                </div>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
{% endblock %}


