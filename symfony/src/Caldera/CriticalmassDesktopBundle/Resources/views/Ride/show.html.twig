{% extends 'CalderaCriticalmassDesktopBundle:Common:StandardTemplate.html.twig' %}

{% if ride.getTitle() %}
    {% set rideTitle = ride.getTitle() %}
{% else %}
    {% set rideTitle = city.getTitle() ~ ' am ' ~ ride.getDateTime().format('d. m. Y') %}
{% endif %}

{% block title %}{{ rideTitle }}{% endblock %}

{% block content %}
    <div class="container">
        <ol class="breadcrumb">
            <li><a href="#">criticalmass.in</a></li>
            <li><a href="{{ path('caldera_criticalmass_desktop_city_list') }}">St√§dteliste</a></li>
            <li><a href="{{ path('caldera_criticalmass_desktop_city_show', { 'citySlug': city.getMainSlugString() }) }}">{{ city.getTitle() }}</a></li>
            <li class="active">{{ rideTitle }}</li>
        </ol>

        <h1>{{ rideTitle }}</h1>

        {% if ride.getDescription() %}
            <p>{{ ride.getDescription() }}</p>
        {% endif %}
        <div class="row">
            <div class="col-lg-6">
                <label>Datum:</label>
                <span>{{ ride.getDateTime.format('d.m.Y') }}</span>
            </div>
            <div class="col-lg-6">
                <label>Uhrzeit:</label>
                <span>{{ ride.getDateTime.format('H:i') }}</span>
            </div>
        </div>

        <a href="{{ path('caldera_criticalmass_desktop_ride_propose', {'citySlug': ride.getCity().getMainSlugString() }) }}" class="btn btn-default">Angaben korrigieren</a>

        <div id="map" style="width: 100%; height: 300px;"></div>
        <script>
            {% if ride.hasLocation() %}
                var mapCenter = L.latLng({{ ride.getLatitude() }}, {{ ride.getLongitude() }});
            {% else %}
                var mapCenter = L.latLng({{ ride.getCity().getLatitude() }}, {{ ride.getCity().getLongitude() }});
            {% endif %}
            var map = L.map('map');
            var tileLayer = L.tileLayer('http://{s}.tile.osm.org/{z}/{x}/{y}.png', {
            attribution: '&copy; <a href="http://osm.org/copyright">OpenStreetMap</a> contributors'
            });

            tileLayer.addTo(map);
            map.setView(mapCenter, 10);

            var marker = L.marker(mapCenter);
            marker.addTo(map);
            marker.bindPopup('<strong>Treffpunkt:</strong> {{ ride.getLocation() }}');
            marker.openPopup();
        </script>
    </div>
{% endblock %}