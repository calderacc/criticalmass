{% extends 'CalderaCriticalmassSiteBundle:Template:FullscreenTemplate.html.twig' %}

{% set menu_selected = 'two' %}

{% block title %}Live{% endblock %}

{% block additionalHeaderElements %}
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/leaflet/0.7.3/leaflet.css" />
{#
    {% javascripts
    '@CalderaCriticalmassSiteBundle/Resources/public/js/external/leaflet/leaflet.groupedlayercontrol.js'
    '@CalderaCriticalmassSiteBundle/Resources/public/js/external/leaflet/L.Control.Locate.js'
    %}
    <script type="text/javascript" src="{{ asset_url }}"></script>
    {% endjavascripts %}
  #}
    <style>
        #map {
            position: absolute;
            top: 30px;
            bottom: 0;
            width: 100%;
            z-index: 0;

        }
        
        div.user-position {
            overflow: hidden;
            border-radius: 50%;
            box-shadow: 0 0 15px 0 black;
        }
        
        div.user-position div.user-position-inline {
            width: 100%;
            height: 100%;
            border-radius: 50%;
            border-width: 3px;
            border-style: solid;
        }
    </style>
{% endblock %}

{% block content %}
    <div id="map">
    </div>

    <script>
        var callback = function(livePage) {
            livePage.addCity('{{ ride.getCity().getCity() }}', '{{ ride.getCity().getTitle() }}', '{{ ride.getCity().getMainSlugString() }}', '{{ ride.getCity().getDescription()|e('js') }}', {{ride.getCity().getLatitude()}},{{ride.getCity().getLongitude()}});

            livePage.addRide(null, '{{ ride.getFancyTitle() }}', '{{ ride.getDescription()|e('js') }}', {{ride.getLatitude()}},{{ride.getLongitude()}},'{{ ride.getLocation() }}', '{{ ride.getDateTime.format('d.m.Y') }}', '{{ ride.getDateTime.format('H:i') }}', '{{ ride.getWeatherForecast() }}')
        };

        var livePage = CriticalMass.loadModule('LivePage', null, null, callback);
    </script>
{% endblock %}

